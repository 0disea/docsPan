---
title: "Executing Intents"
description: "Learn how to create and manage intents for DeFi operations"
---

Intents are the core of Pan - they let you express high-level financial goals that Pan executes automatically. This guide covers everything you need to know about creating and managing intents.

## Creating your first intent

The simplest intent is a lending operation. Here's how to create one:

<CodeGroup>
```bash cURL
curl -X POST https://api.pan.dev/v1/intents \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "walletId": "wallet_abc123",
    "action": "lend",
    "amount": "1000",
    "asset": "USDC",
    "chain": "ethereum-sepolia"
  }'
```

```javascript JavaScript
const intent = await fetch('https://api.pan.dev/v1/intents', {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${process.env.PAN_API_KEY}`,
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    walletId: 'wallet_abc123',
    action: 'lend',
    amount: '1000',
    asset: 'USDC',
    chain: 'ethereum-sepolia'
  })
}).then(r => r.json());

console.log(`Intent created: ${intent.id}`);
console.log(`Status: ${intent.status}`);
```
</CodeGroup>

<ResponseExample>
```json Intent created
{
  "id": "intent_xyz789",
  "walletId": "wallet_abc123",
  "status": "pending",
  "action": "lend",
  "amount": "1000",
  "asset": "USDC",
  "chain": "ethereum-sepolia",
  "createdAt": "2024-01-15T10:30:00Z"
}
```
</ResponseExample>

## Intent parameters

<AccordionGroup>
  <Accordion title="walletId (required)">
    The ID of the wallet that will execute this intent. This wallet must belong to your account.
  </Accordion>
  
  <Accordion title="action (required)">
    The type of intent. Currently only `"lend"` is supported. More actions coming soon.
  </Accordion>
  
  <Accordion title="amount (required)">
    The amount to deposit, specified as a string (e.g., `"1000"` for 1000 USDC). Use the token's base units, not formatted amounts.
  </Accordion>
  
  <Accordion title="asset (optional)">
    The token symbol (e.g., `"USDC"`, `"USDT"`, `"DAI"`). If not specified, Pan will use the default for the chain.
  </Accordion>
  
  <Accordion title="chain (optional)">
    The target blockchain. If not specified, Pan will select the optimal chain. Options: `"ethereum-sepolia"`, `"base-sepolia"`, `"arbitrum-sepolia"`.
  </Accordion>
</AccordionGroup>

## Understanding intent status

Intents go through several statuses as they're processed:

<Steps>
  <Step title="Pending">
    Intent has been created and is queued for processing. This state is typically very brief.
  </Step>
  
  <Step title="Planning">
    Pan is analyzing the wallet state and generating an optimal execution plan. This may take several seconds.
  </Step>
  
  <Step title="Executing">
    Pan is executing transactions on blockchain. This phase can take minutes depending on network conditions.
  </Step>
  
  <Step title="Completed">
    All operations completed successfully. The intent achieved its goal.
  </Step>
  
  <Step title="Failed">
    Something went wrong during execution. Check the error details for more information.
  </Step>
</Steps>

## Checking intent status

Always poll the intent status to track progress:

<CodeGroup>
```javascript JavaScript
async function getIntentStatus(intentId) {
  const response = await fetch(
    `https://api.pan.dev/v1/intents/${intentId}`,
    {
      headers: {
        'Authorization': `Bearer ${process.env.PAN_API_KEY}`
      }
    }
  );
  
  if (!response.ok) {
    throw new Error(`Failed to fetch intent: ${response.statusText}`);
  }
  
  return await response.json();
}

// Poll every 5 seconds
const intent = await getIntentStatus('intent_xyz789');
console.log('Status:', intent.status);
```
</CodeGroup>

## Viewing execution plans

Once Pan starts planning, you can view the execution plan:

<ResponseExample>
```json Intent with execution plan
{
  "id": "intent_xyz789",
  "status": "executing",
  "executionPlan": {
    "steps": [
      {
        "type": "swap",
        "from": "USDT",
        "to": "USDC",
        "amount": "500",
        "chain": "base-sepolia"
      },
      {
        "type": "bridge",
        "from": "base-sepolia",
        "to": "ethereum-sepolia",
        "asset": "USDC",
        "amount": "500"
      },
      {
        "type": "deposit",
        "protocol": "aave",
        "asset": "USDC",
        "amount": "1000",
        "chain": "ethereum-sepolia"
      }
    ],
    "estimatedGas": "0.05 ETH",
    "estimatedCostUsd": "15.00",
    "estimatedTime": "2-5 minutes",
    "strategy": "multi-asset"
  }
}
```
</ResponseExample>

## Best practices

<Tip>
  **Check balances first**: Before creating an intent, check the wallet balance to ensure sufficient funds are available.
</Tip>

<Tip>
  **Show execution plans**: Display the execution plan to users so they understand what will happen. This builds trust and transparency.
</Tip>

<Tip>
  **Provide progress updates**: Poll intent status and update your UI to show users that progress is being made.
</Tip>

<Tip>
  **Handle failures gracefully**: Always check for `failed` status and provide clear error messages to users.
</Tip>

## Common patterns

### Complete intent flow

Here's a complete example that creates an intent and waits for completion:

<CodeGroup>
```javascript JavaScript
async function executeLendIntent(walletId, amount, asset, chain) {
  // 1. Create intent
  const createResponse = await fetch('https://api.pan.dev/v1/intents', {
    method: 'POST',
    headers: {
      'Authorization': `Bearer ${process.env.PAN_API_KEY}`,
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      walletId,
      action: 'lend',
      amount: amount.toString(),
      asset,
      chain
    })
  });
  
  if (!createResponse.ok) {
    throw new Error(`Failed to create intent: ${createResponse.statusText}`);
  }
  
  const intent = await createResponse.json();
  console.log(`Intent created: ${intent.id}`);
  
  // 2. Poll for completion
  const maxAttempts = 120; // 10 minutes at 5-second intervals
  let attempts = 0;
  
  while (attempts < maxAttempts) {
    await new Promise(resolve => setTimeout(resolve, 5000));
    
    const statusResponse = await fetch(
      `https://api.pan.dev/v1/intents/${intent.id}`,
      {
        headers: {
          'Authorization': `Bearer ${process.env.PAN_API_KEY}`
        }
      }
    );
    
    const updatedIntent = await statusResponse.json();
    
    if (updatedIntent.status === 'completed') {
      console.log('Intent completed successfully!');
      return {
        success: true,
        intent: updatedIntent,
        metrics: updatedIntent.metrics
      };
    }
    
    if (updatedIntent.status === 'failed') {
      throw new Error(`Intent failed: ${updatedIntent.error.message}`);
    }
    
    console.log(`Intent ${updatedIntent.status}...`);
    attempts++;
  }
  
  throw new Error('Intent timed out');
}
```
</CodeGroup>

### Validation before intent creation

Validate prerequisites before creating an intent:

<CodeGroup>
```javascript JavaScript
async function createLendIntentWithValidation(walletId, amount, asset, chain) {
  // 1. Check wallet exists
  const wallet = await getWallet(walletId);
  if (!wallet) {
    throw new Error('Wallet not found');
  }
  
  // 2. Check balance
  const balances = await getBalances(walletId);
  const hasFunds = checkSufficientFunds(balances, asset, chain, amount);
  
  if (!hasFunds) {
    throw new Error(`Insufficient ${asset} balance`);
  }
  
  // 3. Create intent
  return await executeLendIntent(walletId, amount, asset, chain);
}
```
</CodeGroup>

## Error handling

Handle common errors appropriately:

<AccordionGroup>
  <Accordion title="Insufficient funds">
    If the wallet doesn't have enough funds, the intent will fail during planning. Check balances first to provide better UX.
  </Accordion>
  
  <Accordion title="Invalid parameters">
    Validate all parameters before sending the request. The API will reject invalid requests with a `400` status.
  </Accordion>
  
  <Accordion title="Network issues">
    If network issues occur during execution, Pan will retry automatically. If all retries fail, the intent will be marked as failed.
  </Accordion>
</AccordionGroup>

## Related guides

<CardGroup cols={2}>
  <Card
    title="Intents concept"
    icon="target"
    href="/guides/concepts/intents"
  >
    Deep dive into how intents work
  </Card>
  <Card
    title="Monitoring status"
    icon="chart-line"
    href="/guides/monitoring-status"
  >
    Best practices for tracking intent execution
  </Card>
  <Card
    title="Execution plans"
    icon="route"
    href="/guides/concepts/execution-plans"
  >
    Understand execution planning
  </Card>
  <Card
    title="Error handling"
    icon="exclamation-triangle"
    href="/guides/best-practices/error-handling"
  >
    Handle errors gracefully
  </Card>
</CardGroup>

