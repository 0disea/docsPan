---
title: "Security"
description: "Security best practices for using Pan API"
---

Security is paramount when working with financial APIs. This guide covers essential security practices for integrating with Pan.

## API key management

<Warning>
  **Never expose API keys**: Your API key is a secret credential. Treat it like a password - never expose it in client-side code, public repositories, or logs.
</Warning>

### Secure storage

<CodeGroup>
```bash Environment variables
# ✅ Good: Use environment variables
export PAN_API_KEY=your_api_key_here

# ❌ Bad: Hardcode in source files
const API_KEY = "sk_live_abc123...";
```

```javascript Server-side only
// ✅ Good: Store in environment variables
const apiKey = process.env.PAN_API_KEY;

// ❌ Bad: Include in client-side code
const apiKey = "sk_live_abc123..."; // Exposed in browser!
```
</CodeGroup>

### Key rotation

Regularly rotate your API keys as part of your security strategy:

<Steps>
  <Step title="Generate new key">
    Create a new API key in the dashboard before revoking the old one.
  </Step>
  
  <Step title="Update application">
    Update your application with the new API key using a staged rollout if possible.
  </Step>
  
  <Step title="Revoke old key">
    Once the new key is working, revoke the old key in the dashboard.
  </Step>
  
  <Step title="Monitor for issues">
    Watch for any authentication errors that might indicate the transition wasn't complete.
  </Step>
</Steps>

## HTTPS only

<Warning>
  Always use HTTPS. The Pan API only accepts encrypted connections. Never make requests over HTTP.
</Warning>

All requests to `https://api.pan.dev` are encrypted in transit. This protects:
- Your API key
- User wallet information
- Transaction details
- Other sensitive data

## Data isolation

Pan implements strict data isolation:

<CardGroup cols={2}>
  <Card title="Account-level isolation" icon="lock">
    Each API key can only access resources (wallets, intents) that belong to its account.
  </Card>
  <Card title="No cross-account access" icon="shield">
    Even if you know another account's resource IDs, you cannot access them.
  </Card>
</CardGroup>

This isolation is enforced at multiple architectural levels, ensuring complete privacy and security.

## Input validation

Always validate user inputs before sending requests to the API:

<CodeGroup>
```javascript JavaScript
function validateWalletCreation(userId) {
  if (!userId || typeof userId !== 'string') {
    throw new Error('userId is required and must be a string');
  }
  
  if (userId.length < 1 || userId.length > 255) {
    throw new Error('userId must be between 1 and 255 characters');
  }
  
  // Validate format if using specific pattern
  // Example: UUID validation
  const uuidRegex = /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;
  if (!uuidRegex.test(userId)) {
    throw new Error('userId must be a valid UUID');
  }
  
  return true;
}
```
</CodeGroup>

## Error message handling

Be careful not to leak sensitive information in error messages shown to users:

<CodeGroup>
```javascript JavaScript
// ✅ Good: Generic error for users
try {
  await createWallet(userId);
} catch (error) {
  if (error.status === 401) {
    showError('Authentication failed. Please contact support.');
  } else {
    showError('Failed to create wallet. Please try again.');
  }
  // Log detailed error server-side only
  console.error('Wallet creation failed:', error);
}

// ❌ Bad: Exposing API errors directly
catch (error) {
  showError(error.message); // May contain sensitive details
}
```
</CodeGroup>

## Rate limiting

Respect rate limits to avoid service disruption:

<AccordionGroup>
  <Accordion title="Monitor rate limit headers">
    Check response headers for rate limit information:
    
    ```javascript
    const response = await fetch(url, options);
    const remaining = response.headers.get('X-RateLimit-Remaining');
    
    if (parseInt(remaining) < 10) {
      // Slow down requests
      await delay(1000);
    }
    ```
  </Accordion>
  
  <Accordion title="Implement exponential backoff">
    If you hit rate limits, back off exponentially:
    
    ```javascript
    async function requestWithRetry(url, options, maxRetries = 3) {
      for (let i = 0; i < maxRetries; i++) {
        const response = await fetch(url, options);
        
        if (response.status !== 429) {
          return response;
        }
        
        const retryAfter = response.headers.get('Retry-After');
        const delay = retryAfter ? parseInt(retryAfter) * 1000 : Math.pow(2, i) * 1000;
        
        await new Promise(resolve => setTimeout(resolve, delay));
      }
      
      throw new Error('Rate limit exceeded after retries');
    }
    ```
  </Accordion>
</AccordionGroup>

## Audit logging

Keep audit logs of important operations:

<CodeGroup>
```javascript JavaScript
async function createWalletWithAudit(userId, metadata) {
  const auditLog = {
    action: 'wallet_created',
    userId: userId,
    timestamp: new Date().toISOString(),
    metadata: metadata
  };
  
  try {
    const wallet = await createWallet(userId, metadata);
    
    // Log success
    await logAudit({
      ...auditLog,
      status: 'success',
      walletId: wallet.id
    });
    
    return wallet;
  } catch (error) {
    // Log failure
    await logAudit({
      ...auditLog,
      status: 'failed',
      error: error.message
    });
    
    throw error;
  }
}
```
</CodeGroup>

## Wallet security

Pan handles all wallet security, but you should:

<Tip>
  ✅ **Use secure user IDs**: Use stable, unique identifiers that can't be guessed
  ✅ **Validate wallet ownership**: Always verify a wallet belongs to the user before allowing operations
  ✅ **Implement access controls**: Only allow authorized users to create or access wallets
</Tip>

<Warning>
  ❌ **Never expose wallet addresses**: While addresses are public, don't unnecessarily expose them
  ❌ **Don't trust client input**: Always validate wallet IDs on the server side
  ❌ **Don't allow wallet enumeration**: Implement proper access controls to prevent enumeration attacks
</Warning>

## Compliance considerations

<CardGroup cols={2}>
  <Card title="Data retention" icon="database">
    Follow applicable regulations for data retention. Pan provides transaction history, but you may need to implement your own retention policies.
  </Card>
  <Card title="User consent" icon="clipboard-check">
    Ensure users consent to DeFi operations and understand the risks involved.
  </Card>
  <Card title="KYC/AML" icon="id-card">
    Implement appropriate Know Your Customer and Anti-Money Laundering procedures as required by your jurisdiction.
  </Card>
  <Card title="Audit trails" icon="file-lines">
    Maintain audit trails of all financial operations for compliance purposes.
  </Card>
</CardGroup>

## Incident response

Have a plan for security incidents:

<Steps>
  <Step title="Detect">
    Monitor for unusual activity, failed authentication attempts, or unexpected API usage patterns.
  </Step>
  
  <Step title="Assess">
    Determine the scope and impact of any security incident.
  </Step>
  
  <Step title="Contain">
    Immediately revoke compromised API keys and disable affected accounts if necessary.
  </Step>
  
  <Step title="Report">
    Report security incidents to Pan support immediately: security@pan.dev
  </Step>
  
  <Step title="Recover">
    Generate new API keys, restore service, and implement additional security measures.
  </Step>
</Steps>

## Security checklist

<Check>
  ✅ API keys stored in environment variables or secrets management
  ✅ All requests use HTTPS
  ✅ Input validation implemented
  ✅ Rate limiting respected
  ✅ Error messages don't leak sensitive information
  ✅ Audit logging in place
  ✅ Incident response plan documented
  ✅ Regular security reviews scheduled
</Check>

## Related guides

<CardGroup cols={2}>
  <Card
    title="Authentication"
    icon="key"
    href="/guides/authentication"
  >
    Learn about API key authentication
  </Card>
  <Card
    title="Error handling"
    icon="exclamation-triangle"
    href="/guides/best-practices/error-handling"
  >
    Handle errors securely
  </Card>
</CardGroup>

